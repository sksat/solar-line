# ADR-004: 二段階の台詞パイプライン

## Status

Accepted

## Context

アニメの台詞データは二つの独立した課題を含む：(1) タイムスタンプ付き台詞テキストの抽出、(2) 話者の判定（きりたん、ケイ等）。VOICEROID 音声は自動字幕の精度が低く、話者判定には文脈理解が必要。

## Decision

**台詞パイプラインを2フェーズに分離する:**

- **Phase 1 (Extraction):** 生の台詞行をタイムスタンプ付きで抽出 → `epXX_lines.json`（自動化可能）
- **Phase 2 (Attribution):** コンテキストを考慮した話者判定 → `epXX_dialogue.json` + `epXX_speakers.json`（完全自動化しない）

## Consequences

- 台詞抽出を再実行しても話者判定の作業が失われない
- 各フェーズを独立してテスト・改善できる
- Phase 2 は LLM/人間のレビューが入る「半自動」プロセスとなり、品質を担保
- ファイル管理が増えるが、データの信頼性が向上
