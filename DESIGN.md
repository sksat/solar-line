# SOLAR LINE 考察

SOLAR LINE はゆえぴこ氏が制作・公開している『良いソフトウェアトーク劇場』の SF シリーズ長編。

ニコニコ: https://www.nicovideo.jp/user/5844196/series/531506
YouTube: https://www.youtube.com/playlist?list=PLsrZ6S47a4FuZHMV5_F6ePsOd3AZ5h_xX

このシリーズでは、太陽系内を宇宙船で駆け巡る描写がたくさんある。この描写では、ΔV など軌道力学的な要素が多くある。
この描写の妥当性を考察すると共に、妥当な場合はどのような条件（適切な天体位置になる時刻、各話各点火描写前の軌道など）であれば描写が成立するかをできるだけ調査するのがこのリポジトリの目的。

調査結果はその問題の大小を問わず、なんらかの形で GitHub Pages から見られるようにする。

GitHub Pages にあるべきものは例えば以下のようなもの
- 各調査に紐付いた Claude Code session のログ
- 各軌道遷移ごとおよび全話での軌道遷移調査レポート。インタラクティブな再現ができるとなおよい。

調査に当たっては、以下のような基盤を整えて進めるとよい。
- Claude Code session log 収集 + Web page 化
- 各話の動画内容および YouTube などにある字幕データの収集スクリプト
  - 収集した生データは gitignore しておくこと
  - ニコニコ動画のコメントは字幕ではないことに留意すること
  - 各レポートでは、適宜必要なものの引用をしてよい。ただし引用の要件を満たすこと。
  - 台詞については、どのキャラクターがいつどんな発言をしたかが重要になってくる。ここについては全自動で行うのではなく、Claude もしくは Codex が文脈を把握することで、正確な発話者を明らかにしておくこと。
    - 文脈や画面、曲調の変化から場面転換を把握すること
  - 台詞パイプラインは2フェーズに分離すること:
    - Phase 1（台詞抽出）: 字幕から発言テキストとタイムスタンプを抽出する。自動化可。出力: `epXX_lines.json`
    - Phase 2（話者判定）: 抽出された台詞に対し、文脈を元に話者を振り分ける。全自動にはしない。出力: `epXX_dialogue.json`
    - ファイルを分けることで、台詞抽出を再度走らせても話者判定の作業が無駄にならない
  - タイムスタンプの精度にも注意を払うこと。複数字幕トラックの照合や、動画内容との整合性確認を行う

解析には Typescript や Rust を用いること。Rust を用いた解析をした場合は、レポートには手元で動作させた解析結果を貼るか、wasm にビルドしてレポートでの再現が可能になるようにすること。
プログラムの開発には TDD のアプローチを取ること。期待する挙動などの仕様をできるだけテストという形で記述することで、プロジェクトが成長してもガードが敷かれるような状態を維持すること。
また、そのテストは CI で常に検証されるようにすること。適宜 CI status を確認することで、うっかり壊してしまったモノを直すことができる。

plan を決める時など、他の意見があるとより精度が高まるような場面では適宜 nice-friend にも相談しながら進める。

元の生データや信頼できる機関から取得したパラメータなど以外は常に信用できるものとは限らないことに気をつける。
そのため、そのレポートやコードがどんな仮定を置いていたかが非常に重要となる。適宜コメントなどを付記したり、付記できるような構造を作っておくこと。

分析において不整合が見つかった場合、単に「非現実的」と結論づけて終わるのではなく、複数のパラメータパターンを想定し、どのパラメータがどうであれば描写が成立するかを議論すること。例えば、質量が異なったら？推力が異なったら？軌道条件が異なったら？という形で可能性の空間を探索し、境界条件や妥当な解釈を提示する。

また、分析で用いるパラメータ（船の質量、推力、軌道半径等）にはすべて出典を明記すること。エピソードのタイムスタンプ、世界設定資料の URL などが根拠となる。出典のないパラメータは分析の信頼性を損なう。

軌道遷移の分析では、ΔV の計算だけでなく、目的天体が実際に到達可能な位置にあるかどうかも検証すること。諸条件から整合する惑星の位置関係を想定し、そこから作中の太陽系日時も計算する。

後のエピソードの解析から明らかになった事実は、解析に使えるデータないし文脈として既存のレポートに追記・清書してよい。各レポートは孤立した分析ではなく、シリーズ全体の文脈の中で相互に参照し合うこと。

クロスエピソード分析はエピソード間比較だけでなく、各船の仕様、技術的整合性、ルート最適性など、エピソード以外の観点からも柔軟に行ってよい。

インタラクティブ軌道遷移グラフにはエンジン点火の描写を含めること。推力フェーズの可視化によりダイアグラムの情報量と直感的理解を高める。

このプロジェクトは Claude Code によるエージェントループによって開発を行う。
そのセッションだけですべての問題を解決しようとせず、問題を切り出してステップバイステップで問題を解決し、次のセッションへ問題解決を引き継ぐこと。
リポジトリ内のファイルへのメモや、commit message が重要となる。

current_tasks/ に現在取り組んでいるタスクとその状況をメモし、取り組んでいる中で新たに出てきたアイデアを ideas/ にメモしておくこと。これらのファイルは commit してよい。

## 考察の観点

SF 作品なので、人間に対する加速度の影響への対策や、現在ではありえない推進器性能は許容される前提。それよりも作中の描写として自然かどうかの観点を重視すること。経過時間・航行距離・天体位置の整合性が重要。

作中の登場人物が別の判断をしていた場合の IF（反事実分析）も行うと考察が深まる。例: 木星フライバイなしの直行ルート、ノズル温存のための低推力航路、など。

## 数式レンダリング

レポートに含まれる数式は、読者にとって見やすくレンダリングされること。KaTeX または MathJax の導入を検討する。

## 文字起こしとデータ管理

- Whisper のモデル（tiny/base/small/medium/large）によって精度が変わる。どんな条件（モデル、言語設定等）で生成した字幕データかを構造的に管理すること。YouTube から取得したデータも同様に条件を記録する。
- Whisper 以外の STT 手段（Google Speech-to-Text、Azure Speech 等）も精度に不安がある場合は検討してよい。
- 話者分離（Speaker Diarization）技術を併用すると、Phase 2 の話者判定精度が向上する可能性がある。
- 動画は gitignore したディレクトリにダウンロードし、字幕抽出や画面分析（OCR等）に利用してよい。
- 字幕抽出・文字起こしデータは GitHub Pages で閲覧可能にすること。

## 軌道遷移図の拡張

- 軌道遷移に複数パターンがある場合、ひとつの軌道遷移図で複数パターンを同時にアニメーションさせると比較がわかりやすい。

## E2E テスト

Markdown の表が壊れるなど、レポートの表示が壊れることがある。Playwright E2E テストを導入して表示の品質を自動検証すること。Playwright CLI も活用すること。

## ワークフローの Skill 化

よく行う作業パターン（字幕抽出、エピソード分析、レポートレビュー等）は Claude Code の Skill として定義し、再利用可能にすること。Anthropic のベストプラクティスに従う。