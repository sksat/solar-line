# Human Directive History

人間（プロジェクトオーナー）からの追加指示の履歴。AGENT_PROMPT.md 経由で受け取り、git history に保存される。

## Phase 1: 初期設定・UI（Task 010-012 前後）

**Commit a3b9d72**
- 動画埋め込み、台詞引用、ΔV チャートの UI 指示

## Phase 2: 字幕・台詞パイプライン（Task 009 前後）

**Commit bff83e9, 9bc8076**
- 台詞パイプラインの2フェーズ分離設計
  - Phase 1（台詞抽出）: `epXX_lines.json` → 自動化可
  - Phase 2（話者判定）: `epXX_dialogue.json` → 全自動にしない
- 主要対話ペア: きりたん ↔ ケストレルAI（ケイ）
- タイムスタンプ精度への注意

## Phase 3: 分析手法（Task 013 前後）

**Commit 93770d1, 58bb068**
- ケストレルの性能評価の根拠が無い → **出典明記の義務化**
- 分析は複数パターンを想定して議論すべき → **パラメータ探索方針**
- 不整合が見つかっても「非現実的」で終わらず、可能性の空間を探索する

## Phase 4: 軌道図・UX 改善（Task 014-019 前後）

**Commit edac046, 9f8056a, d42a153, 2dc0fd3**
- YouTube VTT 精度は限定的 → OCR/STT 基盤構築指示
- 軌道遷移図（惑星軌道、軌跡）の導入
- ΔV カードのテキスト溢れ修正（TDD）
- レポート構造改善:
  - 台詞引用は自然に本文に織り込む
  - 分析のネスト構造（問題 → シナリオ）
  - もっともらしいシナリオを先頭に、非現実的なものは折りたたみ
  - "brachistochrone" を ブラキストクローネ より優先
- ep01 台詞修正: 依頼は**きりたんへの**もの（~01:14）
- インタラクティブ軌道図（タイムスライダー）
- 定期的なレポートレビュー（他セッション/Codex で）

## Phase 5: データ基盤・クロスエピソード（Task 037-041 前後）

**Commit c74ad1e, 12c8b9e, e9f7a2b**
- 軌道図に計算された惑星位置を反映、太陽系の日時を計算
- 後のエピソードの分析結果で既存レポートを更新してよい
- クロスエピソード分析はエピソード構造に限らず柔軟に
- エンジン点火の可視化（推力フェーズのアニメーション）
- 出典リンクのクリック可能化
- 別レポート・別セクションへのナビゲーション

## Phase 6: 高度な分析・レンダリング（Task 052-058 前後）

**Commit 76e3955, 5dfe003**
- 数式レンダリング（KaTeX）
- SF 作品の分析観点: 物理的現実性より**物語的整合性**を重視
- 加速度耐性対策・未来的推進器は許容前提
- Whisper モデルの条件管理、代替 STT 検討
- 話者分離（Speaker Diarization）
- 動画ダウンロードによる OCR/画面分析
- 文字起こしデータの Pages 公開
- 複数パターン軌道図アニメーション
- 反事実（IF）分析
- ワークフローの Skill 化
- Playwright E2E テスト
- 具体的数値分析にはチャート/ダイアグラムを付記

## Phase 7: 判定ポリシー・外部リンク（Task 059-060 前後）

**Commit 0d8fd1f, 70265ee**
- 参考計算に「判定不能」は不要 → 作中描写との直接比較のみ判定
- 外部出典をクリック可能なリンクに
- 机上計算の後に詳細な軌道伝搬で検証

## Phase 8: GitHub Pages・セッション管理

**Commit 17af797** (2026-02-24)
- Pages で GitHub リポジトリへのリンクを明示する
- Anthropic 公式の Skill（frontend-skill 等）を使ってよい
- Session log の改善:
  - agent-loop 標準出力サマリーと conversation log を分離表示
  - conversation log では Assistant (model) のように表記
  - sub-agent にもできれば対応
  - どの commit と紐付いているか明示し、GitHub リンク
- 各分析の読みやすさを非専門家向けにもたまにレビュー（ただし詳細分析が主目的）
- 画面からの分析にはスクリーンショット引用可（引用要件に注意）
- 軌道伝搬は TDD で:
  - 数値積分手法の精度の見積りおよび検証
  - エネルギー保存を指標としたテスト
- 人間からの追加指示の履歴を1枚のファイルにまとめる（本ファイル）

## Phase 9: 積分手法・姿勢制御・通信（最新）

**Commit 9c81a94** (2026-02-24)
- 固定 dt の RK4 は推進器・重力アシストに不利 → TDD で複数手法を試す
  - RK45 (Dormand-Prince) 適応ステップ
  - シンプレクティック積分の検討
  - 効率比較
- 姿勢制御精度・姿勢安定度の考察
  - 推力ベクトル指向精度とミス距離
  - フリップ機動ダイナミクス
  - 推力低下・ノズル損傷の影響
- 通信描写の考察
  - 光速遅延、リンクバジェット、ブラックアウト
  - 作中のリアルタイム会話と物理的遅延の矛盾
- CI 定期確認の指示

## Phase 10: 再分析・UI改善（2026-02-24 3rd batch）

**Commit 2e84925 → 382ab2e** (2026-02-24)
- 分析の再検討: nice-friend による見落とし視点の補完、conditional 判定の再検証
- 図・グラフの充実
- セッションログの更新
- AI コストのページ表示
- 技術解説ページの構造改善（現状まとめ + セクション分け）
- 文字起こし修正のレポート連動
- ヘッダーナビの各話分析/総合分析ドロップダウン分離

## Phase 11: 効率化・開発者体験（2026-02-24 4th batch）

**Commit 92be4cf** (2026-02-24)
- Sonnet 等への単純タスク委任（コスト・レイテンシ削減）、レビュー基準の設定
- rustdoc のビルド・デプロイ
- ログの JST 管理
- コード引用のシンタックスハイライト
- Claude Code 固有ツール（TodoWrite 等）のいい感じの表示

## Phase 12: DAG管理・ADR（2026-02-24 5th batch）

**Commit 49798d1** (2026-02-24)
- タスク・分析の DAG 管理構造
  - 前提の再検討時に影響範囲を追跡可能にする
  - 過去のログも保持し、DAG 操作ユーティリティを構築
  - 過去の DAG をセッションログ・コミットログから再構成
  - DAG のアニメーション表示を技術解説に追加
- ADR（Architecture Decision Records）の導入
  - 設計・分析ポリシーの意思決定を記録
  - 過去の意思決定をセッションログ・コミットログから発掘

## Phase 13: 分析方針・スコープ拡大（2026-02-24 6th batch）

**Commit 879d126** (2026-02-24)
- **設定資料の位置づけ**: 設定資料はあくまで補足資料。本編から得られた情報・パラメータ・条件を分析では重視すること
- **セッションログの取り扱い**: 処理する session log ファイルは workspace にコピーして参照しやすくする（Codex も同様）
- **DAG viewer UX**: ノードクリックで概要・ToDo 状態を表示
- **名称の再検討**: 「考察」より「考証」が適切か？（verification/research のニュアンス）
- **分析スコープ拡大**: 主人公の宇宙船以外にも、他の宇宙船や係留地（mooring points）についても分析を行う

## Phase 14: DAG改善・レビュー体制（2026-02-24 7th batch）

**Commit 8e070a8** (2026-02-24)
- **DAG系統分離**: 分析のDAGとリポジトリのタスク/技術開発のDAGを分けて表示すること
- **DAG履歴閲覧**: 過去の時点のDAGを遡れるviewerにすること
- **DAG全面レビュー**: DAGの正しさを確認し、ツール・意思決定・分析を見直す
- **DAG依存関係操作**: 依存関係の張り替えをやりやすくしておくこと
- **文字起こし再レビュー**: 話者帰属を全体の文脈で再度見直す
- **コスト分析拡充**: max subscription以外のコスト見積もり（通常料金での試算）
- **描写妥当性レビュー**: 年単位の航行は作品の描写からして違和感がある。こうした違和感を発見できるレビュー体制を構築する
